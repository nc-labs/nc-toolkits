import{useRoutes as e,unstable_HistoryRouter as t,useLocation as n}from"react-router-dom";export*from"react-router-dom";import r,{useRef as o,useMemo as a,useState as i,Suspense as c,useLayoutEffect as l}from"react";import{useSize as u,useEventListener as m}from"ahooks";import{createBrowserHistory as s}from"history";import f from"styled-components";import{lazy as d}from"nc-lazy";function h(){return(h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function p(e,t){return t||(t=e.slice(0)),e.raw=t,e}var v,g,x=function(){var e=o(null),t=u(e);return[e,a(function(){return(null==t?void 0:t.height)||0},[t])]},E={useWatcher:function(e,t){m(e,function(e){t(e.detail)})},emitWatcher:function(e,t){return window.dispatchEvent(new CustomEvent(e,{detail:t}))}},b=s(),y=f.header(v||(v=p(["\n  position: sticky;\n  top: 0;\n  left: 0;\n  background: white;\n  box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);\n"]))),w=function(e,t){var n=function(){switch(e){case"headers":return import.meta.glob("/src/layouts/headers/*.tsx");case"footers":return import.meta.glob("/src/layouts/footers/*.tsx");case"contents":return import.meta.glob("/src/layouts/contents/*.tsx");default:return{}}}(),r={},o=t||d;for(var a in n)r[a.split(new RegExp("/src/layouts/"+e+"/|.tsx$|/index.tsx$","g")).join("")||"index"]=o(n[a]);return r},H={headers:w("headers"),footers:w("footers"),contents:w("contents")},O=r.memo(function(e){var t=e.name,n=e.children,o=e.component,i=a(function(){if("none"===t)return r.Fragment;var e=H[o];return e[t]||e.index||r.Fragment},[o,t]);return r.createElement(i,null,n)}),j=f.main(g||(g=p(["\n  min-height: ",";\n"])),function(e){var t=e.headerHeight,n=e.footerHeight;return"calc(100vh - "+((void 0===t?0:t)+(void 0===n?0:n))+"px)"}),k=function(e){var t=import.meta.glob("/src/pages/**/[a-z[]*.tsx"),n=[],o=d,a=function(e){var a;n.push({path:e.split(/\/src\/pages|\.tsx$|\/index\.tsx/g).join("")||"/",element:(a=o(t[e]),r.createElement(a,null))})};for(var i in t)a(i);return n}(),A=function(){return e(k)},W=r.memo(function(e){var n=e.fallback,o=b.location.pathname,l=i({}),u=l[0],m=l[1],s=a(function(){return u[o]},[u,o]),f=x(),d=f[0],p=f[1],v=x(),g=v[0],w=v[1];return E.useWatcher("CHANGE_LAYOUTS",function(e){m(function(t){return h({},t,e)})}),r.createElement(t,{history:b},r.createElement(c,{fallback:n},(null==s?void 0:s.header)&&r.createElement(y,{ref:d},r.createElement(O,{component:"headers",name:s.header})),(null==s?void 0:s.content)&&r.createElement(j,{headerHeight:p,footerHeight:w},r.createElement(O,{component:"contents",name:null==s?void 0:s.content},r.createElement(A,null))),Boolean(null==s?void 0:s.content)||r.createElement("main",null,r.createElement(A,null)),(null==s?void 0:s.footer)&&r.createElement("footer",{ref:g},r.createElement(O,{component:"footers",name:null==s?void 0:s.footer}))))}),C=function(e,t){return function(){var o=n().pathname;return l(function(){var e;E.emitWatcher("CHANGE_LAYOUTS",((e={})[o]={header:(null==t?void 0:t.header)||"index",content:(null==t?void 0:t.content)||"index",footer:(null==t?void 0:t.footer)||"index"},e))},[]),r.createElement(e,null)}};export{W as LayoutProvider,b as history,E as watcher,C as withLayout};
//# sourceMappingURL=index.modern.js.map
