function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var t=require("react-router-dom"),n=require("react"),r=e(n),o=require("ahooks"),u=require("history"),i=e(require("lodash")),a=e(require("styled-components")),s=require("nc-lazy"),c={useWatcher:function(e,t){o.useEventListener(e,function(e){t(e.detail)})},emitWatcher:function(e,t){return window.dispatchEvent(new CustomEvent(e,{detail:t}))}},l=u.createBrowserHistory(),f=function(e){return e.isPreloaded&&e.Component?e.Component:r.lazy(function(e){return function(){return e.isPreloaded?e():Promise.all([e(),new Promise(function(e){return setTimeout(e,1e3)})]).then(function(t){var n=t[0];return e.Component=n.default,n})}}(e))},d=function(e){var t=(void 0)("/src/pages/**/[a-z[]*.tsx"),n=[],o=f,u=function(e){var u,i=e.split(/\/src\/pages|\.tsx$|\/index\.tsx$/g).join("").toLowerCase()||"/";if(!/^(\/[a-z][^\]/\s]*|\/\[[a-z][^/\s]*\])+$|^\/$/g.test(i))return console.warn("[nc-toolkits]",e,"is invalid path."),"continue";i=i.split(/\]/).join("").split(/\/\[/).join("/:"),n.push({path:i,element:(u=o(t[e]),r.createElement(u,null)),preload:t[e]})};for(var a in t)u(a);return{routes:n.map(function(e){return i.pick(e,["path","element"])}),routePreloads:n.map(function(e){return i.pick(e,["path","preload"])})}}(),m=d.routes,p=d.routePreloads,h=function(){return t.useRoutes(m)},v=r.memo(r.forwardRef(function(e,u){var i=n.useRef((null==u?void 0:u.current)||u||null),a=o.useInViewport(i)[0],s=n.useMemo(function(){return"string"==typeof e.to?e.to:e.to.pathname},[JSON.stringify(e.to)]),c=n.useMemo(function(){var e;return null===(e=p.find(function(e){return t.matchPath(e.path,s)}))||void 0===e?void 0:e.preload},[s]);return n.useEffect(function(){a&&c&&(c.isPreloaded||(c(),c.isPreloaded=!0))},[a]),r.createElement(t.Link,Object.assign({},e,{ref:i}))}));function x(){return(x=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function y(e,t){return t||(t=e.slice(0)),e.raw=t,e}var E,g,w=function(){var e=n.useRef(null),t=o.useSize(e);return[e,n.useMemo(function(){return(null==t?void 0:t.height)||0},[t])]},b=a.header(E||(E=y(["\n  position: sticky;\n  top: 0;\n  left: 0;\n  background: white;\n  box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);\n"]))),j=function(e,t){var n=function(){switch(e){case"headers":return(void 0)("/src/layouts/headers/*.tsx");case"footers":return(void 0)("/src/layouts/footers/*.tsx");case"contents":return(void 0)("/src/layouts/contents/*.tsx");default:return{}}}(),r={},o=t||s.lazy;for(var u in n)r[u.split(new RegExp("/src/layouts/"+e+"/|.tsx$|/index.tsx$","g")).join("")||"index"]=o(n[u]);return r},k={headers:j("headers"),footers:j("footers"),contents:j("contents")},P=r.memo(function(e){var t=e.name,o=e.children,u=e.component,i=n.useMemo(function(){if("none"===t)return r.Fragment;var e=k[u];return e[t]||e.index||r.Fragment},[u,t]);return r.createElement(i,null,o)}),O=a.main(g||(g=y(["\n  min-height: ",";\n"])),function(e){var t=e.headerHeight,n=e.footerHeight;return"calc(100vh - "+((void 0===t?0:t)+(void 0===n?0:n))+"px)"}),L=r.memo(function(e){var o=e.fallback,u=l.location.pathname,i=n.useState({}),a=i[0],s=i[1],f=n.useMemo(function(){return a[u]},[a,u]),d=w(),m=d[0],p=d[1],v=w(),y=v[0],E=v[1];return c.useWatcher("CHANGE_LAYOUTS",function(e){s(function(t){return x({},t,e)})}),r.createElement(t.unstable_HistoryRouter,{history:l},r.createElement(n.Suspense,{fallback:o},(null==f?void 0:f.header)&&r.createElement(b,{ref:m},r.createElement(P,{component:"headers",name:f.header})),(null==f?void 0:f.content)&&r.createElement(O,{headerHeight:p,footerHeight:E},r.createElement(P,{component:"contents",name:null==f?void 0:f.content},r.createElement(h,null))),Boolean(null==f?void 0:f.content)||r.createElement("main",null,r.createElement(h,null)),(null==f?void 0:f.footer)&&r.createElement("footer",{ref:y},r.createElement(P,{component:"footers",name:null==f?void 0:f.footer}))))});Object.keys(t).forEach(function(e){"default"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return t[e]}})}),exports.Link=v,exports.Router=L,exports.history=l,exports.lazy=f,exports.watcher=c,exports.withLayout=function(e,o){return function(){var u=t.useLocation().pathname;return n.useLayoutEffect(function(){var e;c.emitWatcher("CHANGE_LAYOUTS",((e={})[u]={header:(null==o?void 0:o.header)||"index",content:(null==o?void 0:o.content)||"index",footer:(null==o?void 0:o.footer)||"index"},e))},[]),r.createElement(e,null)}};
//# sourceMappingURL=index.js.map
